<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shan Khan — Portfolio</title>
  <meta name="description" content="Personal portfolio of Shan Khan — projects, skills, experience, and contact." />
  <meta name="theme-color" content="#0ea5e9" />
  <!-- Open Graph / SEO -->
  <meta property="og:title" content="Shan Khan — Portfolio" />
  <meta property="og:description" content="Projects, skills, experience, and contact." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/preview.png" />
  <link rel="icon"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='18' fill='%230ea5e9'/%3E%3Ctext x='50' y='62' font-size='58' text-anchor='middle' fill='white' font-family='Arial, Helvetica, sans-serif'%3ES%3C/text%3E%3C/svg%3E" />

  <style>
    /*
      Full single-file stylesheet:
      - Keeps your original theme variables/colors.
      - Auto-scaling using clamp().
      - Adds borders where missing.
      - Adds hover/focus effects everywhere.
      - Project cards become horizontally scrollable on small screens with dots indicator + smooth momentum.
      - Keeps your HTML structure and content intact.
    */

    :root {
      /* original theme variables kept */
      --bg: #0b1220;
      --surface: #0f172a;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --brand: #0ea5e9;
      --brand-2: #22d3ee;
      --ring: rgba(14, 165, 233, .35);
      --card: #111827;
      --shadow: 0 8px 30px rgba(2, 8, 23, .35);

      /* scaling and spacing */
      --fs-min: 14px;
      --fs-max: 18px;

      --space-xxs: 0.25rem;
      --space-xs: 0.4rem;
      --space-sm: 0.6rem;
      --space-md: 0.9rem;
      --space-lg: 1.4rem;
      --radius: 12px;
    }

    /* base autoscaling */
    html {
      font-size: clamp(var(--fs-min), 1.6vw + 0.2rem, var(--fs-max));
      scroll-behavior: smooth;
    }

    /* reset and base */
    *,:before,:after { box-sizing: border-box; }
    * { margin: 0; }
    body {
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans";
      -webkit-font-smoothing: antialiased;
      background: linear-gradient(180deg, var(--bg), var(--surface));
      color: var(--text);
      line-height: 1.45;
      -webkit-text-size-adjust: 100%;
      -moz-osx-font-smoothing: grayscale;
      padding-bottom: calc(var(--space-lg) * 1.5);
      font-weight: 400;
    }
    img, svg, canvas, video { max-width: 100%; display: block; height: auto; }
    a { color: inherit; text-decoration: none; }
    button { font: inherit; }

    /* compact container */
    .container { width: min(1100px, 94%); margin-inline: auto; }

    /* NAV */
    header {
      position: sticky;
      top: 0;
      z-index: 60;
      backdrop-filter: saturate(1.12) blur(6px);
      background: color-mix(in oklab, var(--surface) 75%, transparent);
      border-bottom: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
      padding-block: var(--space-xs);
    }

    .nav {
      display: flex; align-items: center; justify-content: space-between;
      gap: var(--space-sm);
      padding-inline: clamp(0.6rem, 2vw, 1.2rem);
    }

    .logo {
      display:flex; align-items:center; gap:.5rem;
      font-weight:700; letter-spacing:.3px;
      border-radius:10px; padding:.08rem .35rem;
      border:1px solid transparent; transition: transform .18s, border-color .18s;
    }
    .logo:hover { transform: translateY(-2px); border-color: color-mix(in oklab, var(--brand) 38%, transparent); }

    .logo-mark {
      width: clamp(34px, 3.4vw, 40px);
      height: clamp(34px, 3.4vw, 40px);
      display:grid; place-items:center; border-radius:10px;
      background: linear-gradient(135deg, var(--brand), var(--brand-2)); color:white;
      box-shadow: var(--shadow);
      border: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
      transition: transform .22s ease;
    }
    .logo:hover .logo-mark { transform: rotate(-6deg) scale(1.02); }

    nav[aria-label="Primary"] ul {
      display:flex; gap: clamp(.4rem, 1.2vw, 1rem); list-style:none; align-items:center;
    }
    nav a {
      padding: .34rem .65rem; border-radius:999px; color:var(--muted);
      font-size: .95rem;
      border:1px solid transparent;
      transition: color .16s, background .16s, transform .16s, border-color .16s, box-shadow .16s;
    }
    nav a:hover, nav a:focus {
      color: var(--text);
      background: color-mix(in oklab, var(--text) 7%, transparent);
      transform: translateY(-1px);
      border-color: color-mix(in oklab, var(--brand) 36%, transparent);
      box-shadow: 0 8px 18px rgba(2,8,23,.12);
    }

    .actions { display:flex; gap:.45rem; align-items:center; }

    .btn {
      display:inline-flex; align-items:center; gap:.45rem;
      padding:.45rem .7rem; border-radius:999px;
      border:1px solid color-mix(in oklab, var(--text) 12%, transparent);
      background: color-mix(in oklab, var(--surface) 62%, transparent);
      color:var(--text); cursor:pointer; font-size:.95rem;
      transition: transform .14s, border-color .14s, box-shadow .14s;
    }
    .btn:hover { transform: translateY(-1px); border-color: color-mix(in oklab, var(--brand) 38%, transparent); box-shadow: 0 8px 18px rgba(2,8,23,.12); }
    .btn:focus { outline: 3px solid var(--ring); }

    .btn.primary {
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #fff; border: 1px solid color-mix(in oklab, var(--brand) 55%, transparent);
    }
    .btn.primary:hover { filter: brightness(1.04); }

    #themeBtn { font-size: 1rem; }
    #menuBtn { font-size: 1.05rem; }

    /* HERO */
    .hero { padding-block: clamp(1.2rem, 4vw, 3rem); }
    .hero-grid { display:grid; grid-template-columns:1.3fr .7fr; gap: clamp(.7rem, 2vw, 2rem); align-items:center; }

    .badge {
      display:inline-flex; align-items:center; gap:.4rem;
      padding:.24rem .5rem; border-radius:999px;
      border:1px dashed color-mix(in oklab, var(--text) 12%, transparent);
      color:var(--muted); font-size:.9rem;
      transition: border-color .14s, color .14s, transform .14s;
    }
    .badge:hover { border-color: var(--brand); color:var(--text); transform: translateY(-1px); }

    .title {
      font-size: clamp(1.25rem, 2.6vw, 2.2rem);
      line-height:1.06; letter-spacing:.2px; margin-top:.25rem;
      border-bottom:1px solid color-mix(in oklab, var(--text) 10%, transparent); padding-bottom:.25rem;
      transition: color .14s, transform .14s, border-color .14s;
    }
    .title:hover { border-color: var(--brand); transform: translateY(-1px); }

    .gradient { background: linear-gradient(135deg, var(--brand), var(--brand-2)); -webkit-background-clip:text; background-clip:text; color:transparent; }

    .lead { margin-top:.45rem; color:var(--muted); font-size: .98rem; }

    .hero-cta { margin-top:.6rem; display:flex; gap:.6rem; flex-wrap:wrap; }

    .stats {
      margin-top:.8rem;
      display:grid; grid-template-columns: repeat(3, 1fr); gap:.6rem;
    }
    .stat {
      padding:.6rem; border-radius:10px; background:var(--card); text-align:center; box-shadow:var(--shadow);
      border:1px solid color-mix(in oklab, var(--text) 10%, transparent); transition: transform .14s, border-color .14s;
      font-size:.95rem;
    }
    .stat:hover { transform: translateY(-2px); border-color: var(--brand); }

    .thumb[aria-label="Profile image placeholder"] { border-radius: 10px; overflow:hidden; border:1px solid color-mix(in oklab, var(--text) 10%, transparent); }
    .thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    /* SECTIONS */
    section { padding-block: clamp(.65rem, 2.0vw, 1.8rem); }
    .section-title {
      font-size: clamp(1.0rem, 1.6vw, 1.2rem);
      margin-bottom:.6rem; display:inline-block; padding-bottom:.2rem;
      border-bottom:1px solid color-mix(in oklab, var(--text) 10%, transparent);
      transition: border-color .14s, transform .14s;
    }
    .section-title:hover { border-color: var(--brand); transform: translateY(-1px); }

    .grid { display:grid; gap:.6rem; }
    .grid.cols-2 { grid-template-columns: repeat(2, 1fr); gap:.8rem; }
    .grid.cols-3 { grid-template-columns: repeat(3, 1fr); gap:.9rem; }

    /* SKILLS */
    .skills { display:flex; flex-wrap:wrap; gap:.45rem; align-items:center; }
    .chip {
      padding:.32rem .6rem; border-radius:999px;
      background: color-mix(in oklab, var(--text) 8%, transparent);
      border:1px solid color-mix(in oklab, var(--text) 12%, transparent);
      font-size:.95rem; transition: background .14s,border-color .14s,transform .14s,box-shadow .14s; cursor:pointer;
    }
    .chip:hover, .chip:focus { background: color-mix(in oklab, var(--brand) 14%, transparent); border-color: var(--brand); transform: translateY(-2px); box-shadow: 0 8px 20px rgba(2,8,23,.12); }
    .card .meta .chip { background: transparent; }

    /* PROJECT CARDS (desktop/tablet grid) */
    .grid.cols-3#projectGrid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap:.9rem;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding:.72rem;
      box-shadow: var(--shadow);
      display:flex; flex-direction:column; gap:.45rem;
      border:1px solid color-mix(in oklab, var(--text) 10%, transparent);
      transition: transform .16s, border-color .16s, box-shadow .16s;
      min-width:0;
      font-size:.95rem;
    }
    .card:hover { transform: translateY(-3px); border-color: var(--brand); box-shadow: 0 14px 34px rgba(2,8,23,.28); }

    .thumb { aspect-ratio: 16/9; border-radius: 8px; overflow:hidden; border:1px solid color-mix(in oklab, var(--text) 8%, transparent); }
    .meta { display:flex; gap:.45rem; flex-wrap:wrap; align-items:center; }
    .card .actions { display:flex; justify-content:space-between; gap:.6rem; flex-wrap:wrap; }

    /* EXTRA: add subtle border to h3 and p where missing */
    h3 { font-size: 1rem; margin-top: .2rem; margin-bottom: .1rem; }
    p.muted, .muted { color: var(--muted); font-size:.95rem; }

    /* HORIZONTAL SCROLL BEHAVIOR ON SMALL SCREENS */
    @media (max-width: 720px) {
      /* scale fonts down slightly for compactness */
      html { font-size: clamp(13px, 2.2vw, 16px); }

      .hero-grid { grid-template-columns: 1fr; gap: .9rem; padding-inline: .6rem; }

      /* project grid becomes horizontal scroll container with snap + momentum */
      #projectGrid {
        display: flex;
        gap: .85rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        padding-inline: .9rem;
        margin-inline: calc(-1 * .9rem);
        padding-bottom: .8rem;
      }

      /* each card width tuned for compact 2-per-visible feel on mobile */
      #projectGrid .card {
        flex: 0 0 calc(72%); /* ~72% width of viewport so you see partial next card */
        scroll-snap-align: start;
      }

      /* stats compact to two columns */
      .stats { grid-template-columns: repeat(2, 1fr); gap:.5rem; }

      /* hide nav list by default on mobile (your menuBtn toggles it) */
      nav ul { display: none; }
    }

    /* tablet medium */
    @media (min-width: 721px) and (max-width: 1000px) {
      .hero-grid { grid-template-columns: 1fr; gap: 1rem; }
      .grid.cols-3#projectGrid { grid-template-columns: repeat(2, minmax(220px, 1fr)); }
      .stats { grid-template-columns: repeat(3, 1fr); }
    }

    /* larger screens */
    @media (min-width: 1001px) {
      .hero-grid { grid-template-columns: 1.3fr .7fr; }
      .grid.cols-3#projectGrid { grid-template-columns: repeat(3, minmax(260px, 1fr)); }
      .stats { grid-template-columns: repeat(3, 1fr); }
    }

    /* hide native scrollbars on supported platforms but keep accessibility */
    #projectGrid::-webkit-scrollbar { height: 8px; }
    #projectGrid::-webkit-scrollbar-thumb { background: color-mix(in oklab, var(--text) 12%, transparent); border-radius: 999px; }
    #projectGrid { scrollbar-width: thin; scrollbar-color: color-mix(in oklab, var(--text) 12%, transparent) transparent; }

    /* DOTS indicator for horizontal scroller */
    .project-dots {
      display:flex; gap:.45rem; justify-content:center; align-items:center; margin-top:.5rem;
    }
    .project-dots button {
      width:10px; height:10px; border-radius:50%; border:1px solid color-mix(in oklab, var(--text) 12%, transparent);
      background: transparent; padding:0; cursor:pointer; transition: transform .14s, background .14s, border-color .14s;
    }
    .project-dots button.active { background: var(--brand); transform: scale(1.12); border-color: color-mix(in oklab, var(--brand) 40%, transparent); }

    /* forms & contact compact */
    form { display:grid; gap:.6rem; }
    input, textarea { background: transparent; border: 1px solid color-mix(in oklab, var(--text) 14%, transparent); padding:.6rem .9rem; border-radius:10px; color:var(--text); font-size:.95rem; }
    textarea { min-height:120px; resize: vertical; }
    input:focus, textarea:focus { outline: 3px solid var(--ring); border-color: transparent; transform: translateY(-1px); }

    /* footer */
    footer { padding-block: .75rem; color: var(--muted); border-top: 1px solid color-mix(in oklab, var(--text) 12%, transparent); font-size:.95rem; }
    footer .skills a { padding: .35rem .6rem; border-radius: 999px; border: 1px solid color-mix(in oklab, var(--text) 14%, transparent); transition: transform .12s, border-color .12s; margin-left:.35rem; display:inline-block; }
    footer .skills a:hover { transform: translateY(-1px); border-color: var(--brand); color:var(--text); }

    /* accessibility preference */
    @media (prefers-reduced-motion: reduce) { * { transition: none !important; animation: none !important; } }
  </style>
</head>

<body>
  <!-- ===== Header / Nav ===== -->
  <header>
    <div class="container nav">
      <a href="#home" class="logo" aria-label="Home">
        <span class="logo-mark">SK</span>
        <span>Shan Khan</span>
      </a>
      <nav aria-label="Primary">
        <ul>
          <li><a href="#projects">Projects</a></li>
          <li><a href="#skills">Skills</a></li>
          <li><a href="#experience">Experience</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </nav>
      <div class="actions">
        <button class="btn" id="themeBtn" aria-label="Toggle theme" title="Toggle light/dark">🌗</button>
        <button class="btn" id="menuBtn" aria-label="Open menu">☰</button>
        <a class="btn primary" href="#contact">Hire Me</a>
      </div>
    </div>
  </header>

  <!-- ===== Hero ===== -->
  <main id="home" class="hero">
    <div class="container hero-grid">
      <div>
        <div class="badge">Available for freelance & full-time</div>
        <h1 class="title">Hi, I'm <span class="gradient">Shan Khan</span> — a Frontend Developer crafting clean, fast,
          delightful web experiences.</h1>
        <p class="lead">I specialize in responsive UI, accessible design systems, and performance-first engineering.
          Below are some recent projects and a snapshot of my skills.</p>
        <div class="hero-cta">
          <a class="btn primary" href="#projects">View Projects</a>
          <a class="btn" href="#contact">Let's Talk</a>
        </div>
        <div class="stats" aria-label="Highlights">
          <div class="stat"><b>10+</b><span>Projects</span></div>
          <div class="stat"><b>5</b><span>Certifications</span></div>
          <div class="stat"><b>1.5yrs</b><span>Experience</span></div>
        </div>
      </div>
      <div>
        <picture class="thumb" aria-label="Profile image placeholder">
          <!-- Replace with your photo -->
          <img src="Portrait of Shan Khan.png" alt="Profile" loading="lazy" />
        </picture>
      </div>
    </div>

    <!-- ===== Projects ===== -->
    <section id="projects" class="container">
      <h2 class="section-title">Projects</h2>
      <div class="actions" style="margin-bottom:.6rem">
        <input id="search" type="search" placeholder="Search projects… (e.g. React, API)" aria-label="Search projects" />
        <div class="skills" role="group" aria-label="Filter projects by tag" style="margin-left:.6rem">
          <button class="btn chip" data-filter="all">All</button>
          <button class="btn chip" data-filter="react">React</button>
          <button class="btn chip" data-filter="vanilla">Vanilla JS</button>
          <button class="btn chip" data-filter="api">API</button>
          <button class="btn chip" data-filter="ui">UI/UX</button>
        </div>
      </div>

      <!-- project grid: will switch to horizontal scroll on small screens -->
      <div class="grid cols-3" id="projectGrid">
        <!-- Card 1 -->
        <article class="card" data-tags="react ui">
          <div class="thumb">
            <img src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1200&auto=format&fit=crop"
              alt="Project thumbnail" loading="lazy" />
          </div>
          <h3>Design System Kit</h3>
          <p class="muted">A reusable component library with tokens, docs, and theming support. Built with React and
            Storybook.</p>
          <div class="meta">
            <span class="chip">React</span>
            <span class="chip">Storybook</span>
            <span class="chip">Accessibility</span>
          </div>
          <div class="actions">
            <a class="btn" href="design-system-kit.html" target="_blank" rel="noreferrer">Run</a>
            <a class="btn" href="#" target="_blank" rel="noreferrer">Code</a>
          </div>
        </article>

        <!-- Card 2 -->
        <article class="card" data-tags="vanilla api ui">
          <div class="thumb">
            <img src="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?q=80&w=1200&auto=format&fit=crop"
              alt="Project thumbnail" loading="lazy" />
          </div>
          <h3>Weather Now</h3>
          <p class="muted">A minimal weather dashboard using geolocation and a public API with offline caching.</p>
          <div class="meta">
            <span class="chip">Vanilla JS</span>
            <span class="chip">API</span>
            <span class="chip">Service Worker</span>
          </div>
          <!-- Weather Now card actions -->
          <div class="actions">
            <a class="btn" href="weather-now.html" target="_blank" rel="noreferrer">Run</a>
            <a class="btn" href="https://github.com/yourusername/weather-now" target="_blank" rel="noreferrer">Code</a>
          </div>
        </article>

        <!-- Card 3 -->
        <article class="card" data-tags="react api">
          <div class="thumb">
            <img src="https://images.unsplash.com/photo-1487014679447-9f8336841d58?q=80&w=1200&auto=format&fit=crop"
              alt="Project thumbnail" loading="lazy" />
          </div>
          <h3>Crypto Tracker</h3>
          <p class="muted">Price tracking app with charts, pagination, and search. Uses a caching layer for speed.</p>
          <div class="meta">
            <span class="chip">React</span>
            <span class="chip">Charts</span>
            <span class="chip">API</span>
          </div>
          <div class="actions">
            <a class="btn" href="crypto-tracker.html" target="_blank" rel="noreferrer">Run</a>
            <a class="btn" href="#" target="_blank" rel="noreferrer">Code</a>
          </div>
        </article>

        <!-- Card 4 -->
        <article class="card" data-tags="react api">
          <div class="thumb">
            <img src="https://images.unsplash.com/photo-1487014679447-9f8336841d58?q=80&w=1200&auto=format&fit=crop"
              alt="Project thumbnail" loading="lazy" />
          </div>
          <h3>🎨 Air Drawing</h3>
          <p>A fun in-browser drawing app with brush controls, color picker, and download support. Works on desktop &
            mobile.</p>
          <div class="meta">
            <span class="chip">React</span>
            <span class="chip">Charts</span>
            <span class="chip">API</span>
          </div>
          <div class="actions">
            <a class="btn" href="Air drawing.html" target="_blank" rel="noreferrer">Run</a>
            <a class="btn" href="#" target="_blank" rel="noreferrer">Code</a>
          </div>
        </article>
      </div>

      <!-- dots indicator (visible when horizontal scroller is active) -->
      <div id="projectDots" class="project-dots" aria-hidden="false" style="display:none;"></div>

      <div class="project-card"></div>
    </section>

    <!-- ===== Skills ===== -->
    <section id="skills" class="container">
      <h2 class="section-title">Skills</h2>
      <div class="skills">
        <span class="chip">HTML5</span>
        <span class="chip">CSS3</span>
        <span class="chip">JavaScript</span>
        <span class="chip">React/angular/bootstrap</span>
        <span class="chip">Tailwind / Sass</span>
        <span class="chip">Node.js</span>
        <span class="chip">Git & GitHub</span>
        <span class="chip">Accessibility (a11y)</span>
        <span class="chip">Performance</span>
        <span class="chip">Figma</span>
      </div>
    </section>

    <!-- ===== Experience ===== -->
    <section id="experience" class="container">
      <h2 class="section-title">Experience</h2>
      <div class="timeline">
        <div class="item">
          <h3>Frontend Developer — Freelance</h3>
          <small class="muted">2025 — Present</small>
          <p>Built landing pages and dashboards for startups, focusing on performance , responsive UI, and
            accessibility.</p>
        </div>
        <div class="item">
          <h3>Web Developer Intern — Example Co.</h3>
          <small class="muted">2024 — 2025</small>
          <p>Implemented components, wrote unit tests, and collaborated with designers to ship features on a weekly
            cadence.</p>
        </div>
      </div>
    </section>

    <!-- ===== Contact ===== -->
    <section id="contact" class="container">
      <h2 class="section-title">Contact</h2>
      <p class="lead">Got a project or a role in mind? Send a message — I usually reply within a day.</p>

      <!-- ORIGINAL contact form format restored exactly -->
      <form id="contactForm" class="contact-form" aria-label="Contact form" action="https://formspree.io/f/manbkaok" method="POST">
        <!-- Note: replace YOUR_FORMSPREE_ID below with your form id -->
        <input type="hidden" name="_subject" value="New message from portfolio">
        <label for="name">Name</label>
        <input id="name" name="name" type="text" required placeholder="Your name">
        <label for="email">Email</label>
        <input id="email" name="_replyto" type="email" required placeholder="you@example.com">
        <label for="message">Message</label>
        <textarea id="message" name="message" rows="4" required placeholder="Say hi…"></textarea>

        <div class="form-actions" style="margin-top:8px">
          <button class="btn" id="sendBtn" type="submit">Send</button>
          <button type="button" id="clearBtn" style="padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)">Clear</button>
        </div>
        <div id="formFeedback" style="margin-top:8px;color:var(--muted);font-size:.95rem"></div>
      </form>

    </section>
  </main>

  <footer>
    <div class="container"
      style="display:flex; justify-content:space-between; align-items:center; gap:1rem; flex-wrap:wrap">
      <small>© <span id="year"></span> Shan Khan. All rights reserved.</small>
      <div class="skills">
        <a href="#" aria-label="GitHub">🐱 GitHub</a>
        <a href="#" aria-label="LinkedIn">💼 LinkedIn</a>
        <a href="#" aria-label="Twitter">🐦 Twitter</a>
      </div>
    </div>
  </footer>

  <script>
    // SETTINGS (kept original)
    const FORM_ENDPOINT = 'https://formspree.io/f/manbkaok';
    const MAILTO_FALLBACK = 'shankhan783863@gmail.com';

    // Utilities
    const $ = (sel, ctx = document) => ctx.querySelector(sel);
    const $$ = (sel, ctx = document) => Array.from(ctx.querySelectorAll(sel));

    // Theme toggle (kept original behavior)
    const themeBtn = document.getElementById('themeBtn');
    const preferLight = window.matchMedia('(prefers-color-scheme: light)');
    const savedTheme = localStorage.getItem('theme');
    const applyTheme = (mode) => {
      if (mode === 'light') document.documentElement.classList.add('light');
      else document.documentElement.classList.remove('light');
      localStorage.setItem('theme', mode);
    }
    applyTheme(savedTheme || (preferLight.matches ? 'light' : 'dark'));
    themeBtn.addEventListener('click', () => {
      const isLight = document.documentElement.classList.toggle('light');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    });

    // Mobile Menu toggle
    const menuBtn = document.getElementById('menuBtn');
    menuBtn?.addEventListener('click', () => {
      const nav = document.querySelector('nav ul');
      const visible = getComputedStyle(nav).display !== 'none';
      nav.style.display = visible ? 'none' : 'flex';
    });

    // Dynamic Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Project Search + Filter (kept original logic, resilient if search not present)
    const grid = document.getElementById('projectGrid');
    const search = document.getElementById('search');
    const filterBtns = $$('[data-filter]');

    function applyFilters() {
      const term = (search && search.value || '').toLowerCase().trim();
      const activeBtn = filterBtns.find(b => b.classList.contains('active')) || { dataset: { filter: 'all' } };
      const tag = activeBtn.dataset.filter;
      $$('#projectGrid .card').forEach(card => {
        const text = card.innerText.toLowerCase();
        const tags = (card.dataset.tags || '').split(' ');
        const matchTerm = !term || text.includes(term);
        const matchTag = tag === 'all' || tags.includes(tag);
        card.style.display = (matchTerm && matchTag) ? '' : 'none';
      });
    }

    if (search) search.addEventListener('input', applyFilters);
    filterBtns.forEach(btn => btn.addEventListener('click', () => {
      filterBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      applyFilters();
    }));

    // Contact form (AJAX to Formspree with fallback) — preserved original behavior
    const contactForm = document.getElementById('contactForm');
    const feedbackEl = document.getElementById('formFeedback');
    if (contactForm) {
      contactForm.addEventListener('submit', function (e) {
        e.preventDefault();
        if (feedbackEl) feedbackEl.textContent = '';
        const submitBtn = document.getElementById('sendBtn');
        if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Sending…'; }

        const formData = new FormData(contactForm);

        fetch(FORM_ENDPOINT, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        }).then(async res => {
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Send'; }
          if (res.ok) {
            if (feedbackEl) { feedbackEl.style.color = '#60a5fa'; feedbackEl.textContent = 'Thanks — message sent. I will reply soon.'; }
            contactForm.reset();
          } else {
            try {
              const data = await res.json();
              if (feedbackEl) { feedbackEl.style.color = '#facc15'; feedbackEl.textContent = (data?.error) ? data.error : 'Could not send — please try again.'; }
            } catch (err) {
              if (feedbackEl) { feedbackEl.style.color = '#facc15'; feedbackEl.textContent = 'Form submit failed. Opening mail client as fallback.'; }
              const name = encodeURIComponent(contactForm.name.value || '');
              const email = encodeURIComponent(contactForm._replyto.value || '');
              const message = encodeURIComponent(contactForm.message.value || '');
              window.location.href = `mailto:${MAILTO_FALLBACK}?subject=${encodeURIComponent('Message from portfolio: '+name)}&body=${message}%0A%0AFrom:%20${name}%20(${email})`;
            }
          }
        }).catch(err => {
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Send'; }
          if (feedbackEl) { feedbackEl.style.color = '#facc15'; feedbackEl.textContent = 'Network error — opening mail client as fallback.'; }
          const name = encodeURIComponent(contactForm.name.value || '');
          const email = encodeURIComponent(contactForm._replyto.value || '');
          const message = encodeURIComponent(contactForm.message.value || '');
          window.location.href = `mailto:${MAILTO_FALLBACK}?subject=${encodeURIComponent('Message from portfolio: '+name)}&body=${message}%0A%0AFrom:%20${name}%20(${email})`;
        });
      });
    }

    // Clear button behaviour (preserved)
    const clearBtn = document.getElementById('clearBtn');
    clearBtn?.addEventListener('click', () => {
      contactForm?.reset();
      if (feedbackEl) feedbackEl.textContent = '';
    });

    // --- Horizontal scroller: dots indicator + smooth momentum + keyboard nav ---
    (function horizontalScrollerWithDots() {
      const pg = document.getElementById('projectGrid');
      const dotsContainer = document.getElementById('projectDots');
      if (!pg || !dotsContainer) return;

      // function to detect if horizontal mode is active (mobile/tablet)
      function isHorizontalMode() {
        return window.matchMedia('(max-width:720px)').matches;
      }

      // build dots based on visible slides in horizontal mode
      function buildDots() {
        dotsContainer.innerHTML = '';
        // only show dots in horizontal mode
        if (!isHorizontalMode()) { dotsContainer.style.display = 'none'; return; }
        const cards = Array.from(pg.querySelectorAll('.card')).filter(c => c.style.display !== 'none');
        if (!cards.length) { dotsContainer.style.display = 'none'; return; }
        dotsContainer.style.display = 'flex';
        cards.forEach((card, i) => {
          const btn = document.createElement('button');
          btn.setAttribute('aria-label', `Go to project ${i + 1}`);
          if (i === 0) btn.classList.add('active');
          btn.addEventListener('click', () => {
            // smooth scroll to card
            const left = card.getBoundingClientRect().left + pg.scrollLeft - pg.getBoundingClientRect().left;
            pg.scrollTo({ left: left, behavior: 'smooth' });
          });
          dotsContainer.appendChild(btn);
        });
      }

      // update active dot based on scroll position
      function updateActiveDot() {
        if (!isHorizontalMode()) return;
        const dots = Array.from(dotsContainer.children);
        if (!dots.length) return;
        const cards = Array.from(pg.querySelectorAll('.card')).filter(c => c.style.display !== 'none');
        // find the card whose left is closest to container left
        let activeIndex = 0;
        let minDist = Infinity;
        cards.forEach((card, i) => {
          const rect = card.getBoundingClientRect();
          const containerRect = pg.getBoundingClientRect();
          const dist = Math.abs(rect.left - containerRect.left);
          if (dist < minDist) { minDist = dist; activeIndex = i; }
        });
        dots.forEach((d, i) => d.classList.toggle('active', i === activeIndex));
      }

      // throttle helper
      function throttle(fn, wait = 100) {
        let last = 0;
        return (...args) => {
          const now = Date.now();
          if (now - last >= wait) {
            last = now;
            fn(...args);
          }
        };
      }

      // initial build
      buildDots();

      // listeners: resize, mutation (cards may get hidden by filters), scroll
      window.addEventListener('resize', () => { buildDots(); updateActiveDot(); });
      pg.addEventListener('scroll', throttle(updateActiveDot, 80));

      // watch for changes to projectGrid children or their display style
      const obs = new MutationObserver(() => { buildDots(); updateActiveDot(); });
      obs.observe(pg, { childList: true, subtree: true, attributes: true, attributeFilter: ['style'] });

      // keyboard support
      pg.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') pg.scrollBy({ left: 240, behavior: 'smooth' });
        if (e.key === 'ArrowLeft') pg.scrollBy({ left: -240, behavior: 'smooth' });
      });

      // nicer touch momentum: ensure smooth scroll for clicks (already used), and allow elastic behavior by default
      // nothing special required; -webkit-overflow-scrolling: touch; is set via CSS

      // update active dot on load (slight delay to ensure layout)
      setTimeout(() => { buildDots(); updateActiveDot(); }, 150);
    })();

    // accessibility: allow focusing project grid for keyboard scrolling
    (function enableProjectGridFocus() {
      const pg = document.getElementById('projectGrid');
      if (pg) {
        pg.tabIndex = -1;
      }
    })();

    // Small accessibility: when using filters, rebuild dots (in case cards hidden/shown)
    const filterButtons = $$('[data-filter]');
    filterButtons.forEach(btn => btn.addEventListener('click', () => {
      // tiny delay to let DOM update via applyFilters
      setTimeout(() => {
        const rebuildEvent = new Event('resize');
        window.dispatchEvent(rebuildEvent);
      }, 200);
    }));
  </script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">
